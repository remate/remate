define("base/utils",["jquery","amaze","underscore"],function(b,c,d){var e={api:{logout:function(a,b){var c=this;$.ajax({url:host+"/logout",type:"POST",dataType:"json",success:function(a){a.errorCode==200?($(window).off("beforeunload.pro"),e.tool.goLogin(1)):b&&b(a.moreInfo)},error:function(a){b&&b("服务器暂时没有相应，请稍后重试...")}})},move:function(a,b){var c=this;$.ajax({url:host+"/shop/movestart",type:"POST",dataType:"json",success:function(c){c.errorCode==200?a&&a(c):b&&b(c.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():b&&b("服务器暂时没有相应，请稍后重试...")}})},moveAgain:function(a,b,c){var d=this;$.ajax({url:host+"/shop/step5",data:{shopUrl:a.shopUrl,option:a.option},type:"POST",dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},checkMoveCode:function(a,b,c,d){var f=this;$.ajax({url:host+"/shop/step2check",type:"POST",dataType:"json",data:{rnd:a,itemId:b},success:function(a){a.errorCode==200?c&&c(a):d&&d(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():d&&d("服务器暂时没有相应，请稍后重试...")}})},getAddressParent:function(a,b,c){if(!a)return!1;$.ajax({url:host+"/zone/"+a+"/parents",type:"POST",dataType:"json",success:function(a){a.data.length?b&&b(a):c&&c()},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},address:function(a,b,c){if(!a)return;var d=this;$.ajax({url:host+"/zone/"+a+"/children",type:"POST",dataType:"json",success:function(a){a.data.length?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},getShopInfo:function(a,b,c){var d=this;$.ajax({url:host+"/shop/"+a,type:"POST",dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},updateShop:function(a,b,c){var d=this;$.ajax({url:host+"/shop/update",type:"POST",data:a,dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},editMobile:function(a,b,c){var d=this;$.ajax({url:host+"/shop/saveMobileAndTel",type:"POST",data:a,dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},updatePostAge:function(a,b,c){var d=this;$.ajax({url:host+"/shop/updatePostageSet",type:"POST",data:a,dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},saveDesc:function(a,b,c){var d=this;$.ajax({url:host+"/fragment/save",type:"POST",data:a,dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},delDesc:function(a,b,c){var d=this;$.ajax({url:host+"/fragment/delete",type:"POST",data:{id:a},dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},setFragment:function(a,b,c){var d=this;$.ajax({url:host+"/shop/set_fragment",type:"POST",data:{enable:a},dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},setFragmentIdx:function(a,b,c){var d=this;$.ajax({url:host+"/fragment/saveIdx",type:"POST",data:{ids:a},dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},getFragList:function(a,b){var c=this;$.ajax({url:host+"/fragment/list",type:"POST",dataType:"json",success:function(c){c.errorCode==200?a&&a(c):b&&b(c.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():b&&b("服务器暂时没有相应，请稍后重试...")}})},changeEnableDesc:function(a,b,c){var d=this;$.ajax({url:host+"/product/changeEnableDesc",type:"POST",data:a,dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},saveProductDesc:function(a,b,c){var d=this;$.ajax({url:host+"/product/saveProductDesc",type:"POST",data:a,dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},saveProductFragment:function(a,b,c){var d=this;$.ajax({url:host+"/productFragment/save",type:"POST",data:a,dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},saveProduct:function(a,b,c){var d=this;$.ajax({url:host+"/product/save",type:"POST",data:a,dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},getProductInfo:function(a,b,c){var d=this;$.ajax({url:host+"/product/"+a,type:"POST",dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},getProductList:function(a,b,c,d){var f=this,g="";switch(a){case"onsale":g="/product/list";break;case"draft":g="/product/list",b.order="statusDraft";break;case"delay":g="/product/list/forsalebyPC";break;case"offsale":g="/product/list",b.order="soldout";break;case"search":g="/product/searchbyPc/"+window.shopId+"/"+b.keyword,delete b.keyword;break;default:g="/product/list"}var h={order:"",direction:"",pageable:!0,page:0,size:8};$.extend(h,b),$.ajax({url:host+g,type:"POST",data:h,dataType:"json",success:function(b){b.errorCode==200?(b.type=a,c&&c(b)):d&&d(b.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():d&&d("服务器暂时没有相应，请稍后重试...")}})},batchInstock:function(a,b,c){var d=this,f={ids:a.join(",")};$.ajax({url:host+"/product/batch-instock",type:"POST",data:f,dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},batchOnsale:function(a,b,c){var d=this,f={ids:a.join(",")};$.ajax({url:host+"/product/batch-onsale",type:"POST",data:f,dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},saveShopCommission:function(a,b,c){var d=this;$.ajax({url:host+"/shop/saveShopCommission",type:"POST",data:{commisionRate:a},dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},saveThirdCommission:function(a,b,c){var d=this;$.ajax({url:host+"/shop/saveThirdCommission",type:"POST",data:a,dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},getLogistics:function(a,b){$.ajax({url:host+"/logistics/list",type:"POST",dataType:"json",success:function(c){c.errorCode==200?a&&a(c):b&&b(c.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():b&&b("获取快递公司失败！")}})},getProCateList:function(a,b,c,d,f){var g="",h=b||0;switch(a){case 1:g="/category/product/list",h=-1;break;case 2:g="/category/product/list";break;case 3:g="/shop/category/list";break;default:g="/category/product/list"}var i={page:0,size:8,id:h};$.extend(i,f),$.ajax({url:host+g,type:"POST",dataType:"json",data:i,success:function(a){a.errorCode==200?c&&c(a):d&&d(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():d&&d("获取店铺分类信息失败！")}})},addProCate:function(a,b,c){$.ajax({url:host+"/shop/category/save",type:"POST",data:{name:a},dataType:"JSON",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("获取店铺分类信息失败！")}})},removeProCate:function(a,b,c){$.ajax({url:host+"/shop/category/batchRemove",type:"POST",dataType:"json",traditional:!0,data:{ids:a},success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("获取店铺分类信息失败！")}})},changeProCate:function(a,b,c,d){$.ajax({url:host+"/category/product/add",type:"POST",dataType:"json",traditional:!0,data:{categoryId:a,productIds:b},success:function(a){a.errorCode==200?c&&c(a):d&&d(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():d&&d("获取店铺分类信息失败！")}})},changeCateName:function(a,b,c,d){$.ajax({url:host+"/shop/category/batchUpdate",type:"POST",dataType:"json",traditional:!0,data:a,success:function(a){a.errorCode==200?b&&b(d):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("修改店铺分类信息失败！")}})},getCategoryList:function(a,b,c){a.id==""&&(a={}),$.ajax({url:host+"/domain/category",type:"GET",dataType:"json",data:a,success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})}},tool:{alert:function(a){var b=$("#J-KD-alert-msg"),c=$("#J-KD-alert"),d=$(".am-dimmer");b.text(a),c.modal({autoClose:!0,closeTime:3e3,onConfirm:function(){this.close()}})},confirm:function(a,b,c){var d=$("#J-KD-confirm-msg"),e=$("#J-KD-confirm");d.text(a),window.confirmFn=b,window.cancelFn=c,e.modal({relatedTarget:this,onConfirm:function(){window.confirmFn&&window.confirmFn($(this.relatedTarget)),this.close()},onCancel:function(){window.cancelFn&&window.cancelFn($(this.relatedTarget)),this.close()}})},getAbsUrl:function(a){var b=new Image;return b.src=a,a=b.src,b.src=null,a},request:function(a){var b=location.href,c=b.substring(b.indexOf("?")+1,b.length).split(/\&|\#/g),d={};for(i=0;j=c[i];i++)d[j.substring(0,j.indexOf("=")).toLowerCase()]=j.substring(j.indexOf("=")+1,j.length);var e=d[a.toLowerCase()];return typeof e=="undefined"?"":e},goLogin:function(a){a?e.tool.alert("退出成功～"):e.tool.alert("由于您长时间没有操作，请重新登录～"),setTimeout(function(){location.href="/sellerpc/pc/login.html"},1e3)},scoreStarShow:function(a){var b={trigger:".mod-score",font:"12px",colorS:"#f9b700",colorE:"#e9e9e9",scoreAll:5,scoreShow:0,eventClk:!0},c=$.extend(b,a),d="";for(var e=0;e<c.scoreAll;e++)e<Math.round(c.scoreShow)?d+='<em class="solid">&#xe620;</em>':d+='<em class="empty">&#xe61f;</em>';$(c.trigger).append(d),c.eventClk&&$(document).on("click",c.trigger+" em",function(){var a=$(this);if(a.next("em").hasClass("solid")||a.prev("em").hasClass("empty"))return!1;a.hasClass("solid")?a.removeClass("solid").addClass("empty").html("&#xe61f;"):a.removeClass("empty").addClass("solid").html("&#xe620;")})},getStringLength:function(b,c,d,e){var f=0,g=0;str_cut=new String,g=b.length;if(c=1){for(var h=0;h<g;h++)a=b.charAt(h),f++,escape(a).length>4&&f++;return f}if(c=2){for(var h=0;h<g;h++){a=b.charAt(h),f++,escape(a).length>4&&f++,str_cut=str_cut.concat(a);if(f>=d)return e&&e.length>0&&(str_cut=str_cut.concat(e)),str_cut}if(f<d)return b}}}};return e}),define("address",["jquery","base/utils","amaze"],function(a,b,c){function d(){}return d.prototype.init=function(a,b,c,d,e){var f=this;this.pro=b,this.city=c,this.district=d,this.leave=a;var e=e.province?e:{province:2,city:4};this.renderProvince(function(){e&&e.province&&(f.pro.find('option[value="'+e.province+'"]').attr("selected","selected"),f.pro.trigger("chosen:updated.chosen"),f.changePro())}),e&&e.province&&this.renderCity(e.province,function(){e&&e.city&&(f.city.find('option[value="'+e.city+'"]').attr("selected","selected"),f.city.trigger("chosen:updated.chosen"))}),f.leave==3&&e&&e.city&&this.renderDistrict(e.city,function(){e&&e.district&&(f.district.find('option[value="'+e.district+'"]').attr("selected","selected"),f.district.trigger("chosen:updated.chosen"))}),this.changePro(),f.leave==3&&this.changecity()},d.prototype.renderProvince=function(a){var c=this;b.api.address(1,function(b){c.pro.empty(),$.each(b.data,function(a,b){c.pro.append('<option value="'+b.id+'">'+b.name+"</option>")}),c.pro.find("option:eq(0)").attr("selected",!0),c.pro.trigger("chosen:updated.chosen"),a&&a()})},d.prototype.renderCity=function(a,c){var d=this;b.api.address(a,function(a){d.city.next(".chosen-container").show(),d.city.empty(),$.each(a.data,function(a,b){d.city.append('<option value="'+b.id+'">'+b.name+"</option>")}),d.city.find("option:eq(0)").attr("selected",!0),d.leave==3&&d.renderDistrict(d.city.find("option:eq(0)").attr("value")),d.city.trigger("chosen:updated.chosen"),c&&c()},function(){d.district&&d.district.empty().next(".chosen-container").hide(),d.city.empty().next(".chosen-container").hide(),d.city.trigger("chosen:updated.chosen"),d.leave==3&&d.district.trigger("chosen:updated.chosen")})},d.prototype.renderDistrict=function(a,c){var d=this;b.api.address(a,function(a){d.district.next(".chosen-container").show(),d.district.empty(),$.each(a.data,function(a,b){d.district.append('<option value="'+b.id+'">'+b.name+"</option>")}),d.district.find("option:eq(0)").attr("selected",!0),d.district.trigger("chosen:updated.chosen"),c&&c()},function(){d.district.empty().next(".chosen-container").hide(),d.district.trigger("chosen:updated.chosen")})},d.prototype.changePro=function(){var a=this;a.pro.on("change",function(){var b=a.pro.val();a.renderCity(b)})},d.prototype.changecity=function(){var a=this;a.city.on("change",function(){var b=a.city.val();a.leave==3&&a.renderDistrict(b)})},d}),define("base/set-shop/render",["jquery","amaze","base/utils","address"],function(a,b,c,d){var e=$("#shop-name"),f=$("#shop-weixin"),g=$("#shop-desc"),h=$("select.shop-province"),i=$("select.shop-city"),j=$(".shop-notice"),k=$(".shop-background img"),l=$(".shop-img img"),m=$(".shop-danbao"),n=$("#shop-mobile"),o=$("#shop-mobileType");c.api.getShopInfo(window.shopId,function(a){e.val(a.data.name),n.val(a.data.mobile).attr({"data-num1":a.data.mobile,"data-num2":""}),o.val(a.data.mobileType),o.trigger("chosen:updated.chosen"),f.val(a.data.wechat),g.val(a.data.description),j.val(a.data.bulletin),a.data.banner&&k.attr("src",a.data.bannerUrl).attr("data-src",a.data.banner),a.data.imgUrl&&l.attr("src",a.data.imgUrl).attr("data-src",a.data.img);var b=new d;b.init(2,h,i,null,{province:a.data.provinceId,city:a.data.cityId}),a.data.danbao&&(m.find(".danbao-readed").iCheck("check"),m.find(".danbao-open").attr("checked",!0).show().trigger("change"),m.find(".danbao-open").parents(".bootstrap-switch").css("display","inline-block")),window.canSubmit=!0}),m.find(".danbao-readed").on("change",function(){var a=this;$(this).is(":checked")?m.find(".danbao-open").parents(".bootstrap-switch").css("display","inline-block"):m.find(".danbao-open").parents(".bootstrap-switch").css("display","none")}),$("#shop-mobileType").on("change",function(){var a=$("#shop-mobile");a.toggleClass("active"),a.hasClass("active")?(a.attr("data-num1",a.val()),a.val(a.attr("data-num2"))):(a.attr("data-num2",a.val()),a.val(a.attr("data-num1"))),a.focus()})}),define("base/set-postage/form-cancel",["jquery"],function(a){return a("#J-all-cancel").on("click",function(){location.reload()}),null}),define("base/set-shop/save",["jquery","amaze","base/utils"],function(a,b,c){var d=$("#shop-name"),e=$("#shop-weixin"),f=$("#shop-desc"),g=$(".shop-province"),h=$(".shop-city"),i=$(".shop-notice"),j=$(".shop-background img"),k=$(".shop-img img"),l=$(".shop-danbao"),m=$("#shop-mobile"),n=$("#shop-mobileType");return{save:function(){if(!l.find(".danbao-readed").is(":checked")||!l.find(".danbao-open").is(":checked"))return c.tool.alert("请阅读并同意担保交易！"),!1;var a={mobileType:n.val(),mobile:m.val()},b={name:d.val(),wechat:e.val(),description:f.val(),provinceId:g.val(),cityId:h.val(),bulletin:i.val(),banner:j.attr("data-src"),img:k.attr("data-src"),danbao:l.find(".danbao-open").is(":checked")};c.api.editMobile(a,function(a){c.api.updateShop(b,function(b){a.errorCode==200?c.tool.alert("您的数据提交成功！"):c.tool.alert("联系电话保存失败！"),setTimeout(function(){location.reload()},1e3)},function(a){c.tool.alert(a)})})}}}),define("base/set-shop/form-check",["jquery","validate","base/set-shop/save"],function(a,b,c){var d=$("#J-shop-form");return $(".set-footer .am-btn-comfirm-yes").on("click",function(){window.canSubmit&&d.submit()}),$.validator.addMethod("sellerMobile",function(a,b){var c=a.length;return this.optional(b)||/^[\+,\-,\d]{0,16}$/.test(a)},"请正确填写您的手机号码"),d.validate({debug:!1,focusInvalid:!0,onkeyup:!1,errorPlacement:function(a,b){a.appendTo(b.parents(".am-form-group"))},submitHandler:function(a){c.save()},rules:{"shop-name":{required:!0,minlength:2,maxlength:50},"shop-weixin":{maxlength:40},"shop-desc":{required:!0,maxlength:200},"shop-province":{required:!0},"shop-notice":{maxlength:200},"shop-mobile":{required:!0,sellerMobile:!0}},messages:{"shop-name":{required:"店铺名称不能为空",minlength:"店铺名称长度必须在2到50个字之间",maxlength:"店铺名称长度必须在2到50个字之间"},"shop-weixin":{maxlength:"微信长度最长为40个字符"},"shop-desc":{required:"店铺说明不能为空",maxlength:"店铺说明长度最长为200个字符"},"shop-province":{required:"店铺所在地不能为空"},"shop-notice":{maxlength:"店铺公告长度最长为200个字符"},"shop-mobile":{required:"联系电话不能为空",sellerMobile:"联系电话只允许输入+、-和数字，不能大于16位"}}}),null}),define("base/set-shop/upload",["jquery","base/utils","upload"],function(a,b,c){c({id:"J-banner-upload"},function(a){var a=JSON.parse(a);if(a.data&&a.data.length){var b=a.data[0].id,c=a.data[0].url;$(".shop-background img").attr("src",c).attr("data-src",b)}},function(a){b.tool.alert("上传失败,请稍后重试！"),console.log(a)}),c({id:"J-img-upload"},function(a){var a=JSON.parse(a);if(a.data&&a.data.length){var b=a.data[0].id,c=a.data[0].url;$(".shop-img img").attr("src",c).attr("data-src",b)}},function(a){b.tool.alert("上传失败,请稍后重试！"),console.log(a)})}),require(["base/set-shop/render"]),require(["base/set-postage/form-cancel"]),require(["base/set-shop/form-check"]),require(["base/set-shop/upload"]),define("base/set-shop",function(){})