define("base/utils",["jquery","amaze","underscore"],function(b,c,d){var e={api:{logout:function(a,b){var c=this;$.ajax({url:host+"/logout",type:"POST",dataType:"json",success:function(a){a.errorCode==200?($(window).off("beforeunload.pro"),e.tool.goLogin(1)):b&&b(a.moreInfo)},error:function(a){b&&b("服务器暂时没有相应，请稍后重试...")}})},move:function(a,b){var c=this;$.ajax({url:host+"/shop/movestart",type:"POST",dataType:"json",success:function(c){c.errorCode==200?a&&a(c):b&&b(c.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():b&&b("服务器暂时没有相应，请稍后重试...")}})},moveAgain:function(a,b,c){var d=this;$.ajax({url:host+"/shop/step5",data:{shopUrl:a.shopUrl,option:a.option},type:"POST",dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},checkMoveCode:function(a,b,c,d){var f=this;$.ajax({url:host+"/shop/step2check",type:"POST",dataType:"json",data:{rnd:a,itemId:b},success:function(a){a.errorCode==200?c&&c(a):d&&d(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():d&&d("服务器暂时没有相应，请稍后重试...")}})},getAddressParent:function(a,b,c){if(!a)return!1;$.ajax({url:host+"/zone/"+a+"/parents",type:"POST",dataType:"json",success:function(a){a.data.length?b&&b(a):c&&c()},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},address:function(a,b,c){if(!a)return;var d=this;$.ajax({url:host+"/zone/"+a+"/children",type:"POST",dataType:"json",success:function(a){a.data.length?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},getShopInfo:function(a,b,c){var d=this;$.ajax({url:host+"/shop/"+a,type:"POST",dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},updateShop:function(a,b,c){var d=this;$.ajax({url:host+"/shop/update",type:"POST",data:a,dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},editMobile:function(a,b,c){var d=this;$.ajax({url:host+"/shop/saveMobileAndTel",type:"POST",data:a,dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},updatePostAge:function(a,b,c){var d=this;$.ajax({url:host+"/shop/updatePostageSet",type:"POST",data:a,dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},saveDesc:function(a,b,c){var d=this;$.ajax({url:host+"/fragment/save",type:"POST",data:a,dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},delDesc:function(a,b,c){var d=this;$.ajax({url:host+"/fragment/delete",type:"POST",data:{id:a},dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},setFragment:function(a,b,c){var d=this;$.ajax({url:host+"/shop/set_fragment",type:"POST",data:{enable:a},dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},setFragmentIdx:function(a,b,c){var d=this;$.ajax({url:host+"/fragment/saveIdx",type:"POST",data:{ids:a},dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},getFragList:function(a,b){var c=this;$.ajax({url:host+"/fragment/list",type:"POST",dataType:"json",success:function(c){c.errorCode==200?a&&a(c):b&&b(c.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():b&&b("服务器暂时没有相应，请稍后重试...")}})},changeEnableDesc:function(a,b,c){var d=this;$.ajax({url:host+"/product/changeEnableDesc",type:"POST",data:a,dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},saveProductDesc:function(a,b,c){var d=this;$.ajax({url:host+"/product/saveProductDesc",type:"POST",data:a,dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},saveProductFragment:function(a,b,c){var d=this;$.ajax({url:host+"/productFragment/save",type:"POST",data:a,dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},saveProduct:function(a,b,c){var d=this;$.ajax({url:host+"/product/save",type:"POST",data:a,dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},getProductInfo:function(a,b,c){var d=this;$.ajax({url:host+"/product/"+a,type:"POST",dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},getProductList:function(a,b,c,d){var f=this,g="";switch(a){case"onsale":g="/product/list";break;case"draft":g="/product/list",b.order="statusDraft";break;case"delay":g="/product/list/forsalebyPC";break;case"offsale":g="/product/list",b.order="soldout";break;case"search":g="/product/searchbyPc/"+window.shopId+"/"+b.keyword,delete b.keyword;break;default:g="/product/list"}var h={order:"",direction:"",pageable:!0,page:0,size:8};$.extend(h,b),$.ajax({url:host+g,type:"POST",data:h,dataType:"json",success:function(b){b.errorCode==200?(b.type=a,c&&c(b)):d&&d(b.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():d&&d("服务器暂时没有相应，请稍后重试...")}})},batchInstock:function(a,b,c){var d=this,f={ids:a.join(",")};$.ajax({url:host+"/product/batch-instock",type:"POST",data:f,dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},batchOnsale:function(a,b,c){var d=this,f={ids:a.join(",")};$.ajax({url:host+"/product/batch-onsale",type:"POST",data:f,dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},saveShopCommission:function(a,b,c){var d=this;$.ajax({url:host+"/shop/saveShopCommission",type:"POST",data:{commisionRate:a},dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},saveThirdCommission:function(a,b,c){var d=this;$.ajax({url:host+"/shop/saveThirdCommission",type:"POST",data:a,dataType:"json",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})},getLogistics:function(a,b){$.ajax({url:host+"/logistics/list",type:"POST",dataType:"json",success:function(c){c.errorCode==200?a&&a(c):b&&b(c.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():b&&b("获取快递公司失败！")}})},getProCateList:function(a,b,c,d,f){var g="",h=b||0;switch(a){case 1:g="/category/product/list",h=-1;break;case 2:g="/category/product/list";break;case 3:g="/shop/category/list";break;default:g="/category/product/list"}var i={page:0,size:8,id:h};$.extend(i,f),$.ajax({url:host+g,type:"POST",dataType:"json",data:i,success:function(a){a.errorCode==200?c&&c(a):d&&d(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():d&&d("获取店铺分类信息失败！")}})},addProCate:function(a,b,c){$.ajax({url:host+"/shop/category/save",type:"POST",data:{name:a},dataType:"JSON",success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("获取店铺分类信息失败！")}})},removeProCate:function(a,b,c){$.ajax({url:host+"/shop/category/batchRemove",type:"POST",dataType:"json",traditional:!0,data:{ids:a},success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("获取店铺分类信息失败！")}})},changeProCate:function(a,b,c,d){$.ajax({url:host+"/category/product/add",type:"POST",dataType:"json",traditional:!0,data:{categoryId:a,productIds:b},success:function(a){a.errorCode==200?c&&c(a):d&&d(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():d&&d("获取店铺分类信息失败！")}})},changeCateName:function(a,b,c,d){$.ajax({url:host+"/shop/category/batchUpdate",type:"POST",dataType:"json",traditional:!0,data:a,success:function(a){a.errorCode==200?b&&b(d):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("修改店铺分类信息失败！")}})},getCategoryList:function(a,b,c){a.id==""&&(a={}),$.ajax({url:host+"/domain/category",type:"GET",dataType:"json",data:a,success:function(a){a.errorCode==200?b&&b(a):c&&c(a.moreInfo)},error:function(a){a.status==401?e.tool.goLogin():c&&c("服务器暂时没有相应，请稍后重试...")}})}},tool:{alert:function(a){var b=$("#J-KD-alert-msg"),c=$("#J-KD-alert"),d=$(".am-dimmer");b.text(a),c.modal({autoClose:!0,closeTime:3e3,onConfirm:function(){this.close()}})},confirm:function(a,b,c){var d=$("#J-KD-confirm-msg"),e=$("#J-KD-confirm");d.text(a),window.confirmFn=b,window.cancelFn=c,e.modal({relatedTarget:this,onConfirm:function(){window.confirmFn&&window.confirmFn($(this.relatedTarget)),this.close()},onCancel:function(){window.cancelFn&&window.cancelFn($(this.relatedTarget)),this.close()}})},getAbsUrl:function(a){var b=new Image;return b.src=a,a=b.src,b.src=null,a},request:function(a){var b=location.href,c=b.substring(b.indexOf("?")+1,b.length).split(/\&|\#/g),d={};for(i=0;j=c[i];i++)d[j.substring(0,j.indexOf("=")).toLowerCase()]=j.substring(j.indexOf("=")+1,j.length);var e=d[a.toLowerCase()];return typeof e=="undefined"?"":e},goLogin:function(a){a?e.tool.alert("退出成功～"):e.tool.alert("由于您长时间没有操作，请重新登录～"),setTimeout(function(){location.href="/sellerpc/pc/login.html"},1e3)},scoreStarShow:function(a){var b={trigger:".mod-score",font:"12px",colorS:"#f9b700",colorE:"#e9e9e9",scoreAll:5,scoreShow:0,eventClk:!0},c=$.extend(b,a),d="";for(var e=0;e<c.scoreAll;e++)e<Math.round(c.scoreShow)?d+='<em class="solid">&#xe620;</em>':d+='<em class="empty">&#xe61f;</em>';$(c.trigger).append(d),c.eventClk&&$(document).on("click",c.trigger+" em",function(){var a=$(this);if(a.next("em").hasClass("solid")||a.prev("em").hasClass("empty"))return!1;a.hasClass("solid")?a.removeClass("solid").addClass("empty").html("&#xe61f;"):a.removeClass("empty").addClass("solid").html("&#xe620;")})},getStringLength:function(b,c,d,e){var f=0,g=0;str_cut=new String,g=b.length;if(c=1){for(var h=0;h<g;h++)a=b.charAt(h),f++,escape(a).length>4&&f++;return f}if(c=2){for(var h=0;h<g;h++){a=b.charAt(h),f++,escape(a).length>4&&f++,str_cut=str_cut.concat(a);if(f>=d)return e&&e.length>0&&(str_cut=str_cut.concat(e)),str_cut}if(f<d)return b}}}};return e}),define("base/all/checkbox",["jquery","icheck"],function(a,b){$.fn.extend({initCheck:function(){return this.each(function(){$(this).iCheck({checkboxClass:"icheckbox",radioClass:"iradiobox"}),$(".icheck").on("ifChecked",function(){var a=$(this),b=a.attr("name"),c=$('.icheckbox input[name="'+b+'"]').length,d=$('.icheckbox input[name="'+b+'"]:checked').length;c===d&&$("input.checkAll[group="+b+"]").iCheck("check")}).on("ifUnchecked",function(){var a=$(this),b=a.attr("name");$("input.checkAll[group="+b+"]").iCheck("uncheck")})}),$("input.checkAll").on("ifChecked",function(){$("input[name="+$(this).attr("group")+"]").iCheck("check")}).on("ifClicked",function(){$("input[name="+$(this).attr("group")+"]:checked")&&$("input[name="+$(this).attr("group")+"]").iCheck("uncheck")}),this}}),$(".kd-checkbox,.kd-radio").initCheck()}),define("base/myproduct/getData",["jquery","base/utils","doT","moment","pager","base/all/checkbox"],function(a,b,c,d,e,f){function j(){if(i)return;i=!0;var a=$('[name="pageSize"]').val(),d=$('[name="pageNum"]').val(),e=(d-1)*a,f=$('[name="orderField"]').val(),k=$('[name="direction"]').val(),l=$(".am-form-search input").val(),m=$('[name="status"]').val(),n={};n.order=f,$("#J-downs,#J-ups").hide(),m=="onsale"?$("#J-downs").show():m=="offsale"&&$("#J-ups").show(),m=="delay"?$(".am-table-sort .col2 i").html("计划发布时间"):$(".am-table-sort .col2 i").html("销量"),f&&(n.direction=k),l&&(n.keyword=l),n.page=d-1,n.size=a,b.api.getProductList(m,n,function(a){i=!1;var b=c.template(g);$(".order-item-body").html(b(a)),$(".checkAll").attr("checked",!1),$(".kd-checkbox,.kd-radio").initCheck(),h.init($(".pagers"),{count:a.data.categoryTotal,current_page:$('[name="pageNum"]').val()-1,callback:function(a){return $('[name="pageNum"]').val(a+1),a>=0&&j(),!1}})},function(a){i=!1})}window.moment=d;var g=$(".tpl-proList").html(),h=new e,i=!1;return j}),define("base/myproduct/down",["jquery","base/utils","base/myproduct/getData"],function(a,b,c){$("body").on("click",".btn-proOff",function(){b.tool.confirm.call(this,"确认下架此商品？",function(a){b.api.batchInstock([a.attr("data-id")],function(a){a.data.failList.length?b.tool.alert("商品由于参加活动未能下架成功！"):(b.tool.alert("下架成功"),$(".order-item-body tr").length||($("[name=pageNum]").val($("[name=pageNum]").val()>1?Number($("[name=pageNum]").val())-1:1),that.getProduct())),c()},function(a){b.tool.alert(a)})})}),$("#J-downs").on("click",function(){var a=[];if(!$('.order-item-body [name="productId"]:checked').length){b.tool.alert("请选择要下架的商品");return}$('.order-item-body [name="productId"]:checked').each(function(){a.push($(this).parents("tr").attr("data-id"))}),b.tool.confirm.call(this,"确认下架这些商品？",function(){b.api.batchInstock(a,function(a){a.data.failList.length?b.tool.alert("部分商品由于参加活动未能下架成功！"):(b.tool.alert("下架成功"),$(".order-item-body tr").length||($("[name=pageNum]").val($("[name=pageNum]").val()>1?Number($("[name=pageNum]").val())-1:1),that.getProduct())),c()},function(a){b.tool.alert(a)})})})}),define("base/myproduct/up",["jquery","base/utils","base/myproduct/getData"],function(a,b,c){$("body").on("click",".btn-proOn",function(){b.tool.confirm.call(this,"确认上架此商品？",function(a){b.api.batchOnsale([a.attr("data-id")],function(a){a.data.failList.length?b.tool.alert("商品由于参加活动未能上架成功！"):(b.tool.alert("上架成功"),$(".order-item-body tr").length||($("[name=pageNum]").val($("[name=pageNum]").val()>1?Number($("[name=pageNum]").val())-1:1),that.getProduct())),c()},function(a){b.tool.alert(a)})})}),$("#J-ups").on("click",function(){var a=[];if(!$('.order-item-body [name="productId"]:checked').length){b.tool.alert("请选择要上架的商品");return}$('.order-item-body [name="productId"]:checked').each(function(){a.push($(this).parents("tr").attr("data-id"))}),b.tool.confirm.call(this,"确认上架这些商品？",function(){b.api.batchOnsale(a,function(a){a.data.failList.length?b.tool.alert("部分商品由于参加活动未能上架成功！"):(b.tool.alert("上架成功"),$(".order-item-body tr").length||($("[name=pageNum]").val($("[name=pageNum]").val()>1?Number($("[name=pageNum]").val())-1:1),that.getProduct())),c()},function(a){b.tool.alert(a)})})})}),define("base/myproduct/initParams",["jquery"],function(a){return function(a,b,c,d,e,f){a?($('[name="keyword"]').val(a),$(".am-table-sort em").hide()):$(".am-form-search input").val(""),$('[name="pageOffset"]').val(b),c?($('[name="orderField"]').val("sales"),$('[name="direction"]').val(c)):d?($('[name="orderField"]').val("amount"),$('[name="direction"]').val(d)):e?($('[name="orderField"]').val("price"),$('[name="direction"]').val(e)):($('[name="orderField"]').val(""),$('[name="direction"]').val("")),f&&$('[name="status"]').val(f)}}),define("base/myproduct/change",["jquery","base/myproduct/getData","base/myproduct/initParams"],function(a,b,c){var d=$(".am-table-sort em"),e=$('[name="productStatus"]');e.on("change",function(){var a=$(this).val(),f=$(this);if(a=="search")return;a=="onsale"?(d.show(),$(".j-downs").css("display","inline-block"),$(".j-ups").hide()):a=="offsale"?(d.hide(),$(".j-downs").hide(),$(".j-ups").css("display","inline-block")):(d.hide(),$(".j-downs").hide(),$(".j-ups").hide()),c(0,0,0,0,0,a),$('[name="pageNum"]').val(1),a!="search"&&e.find('option[value="search"]').length&&(e.find('option[value="search"]').remove(),e.trigger("chosen:updated.chosen")),b()})}),define("base/myproduct/sort",["jquery","base/myproduct/getData","base/myproduct/initParams"],function(a,b,c){return function(){$("body").on("click",".j-order",function(){$(this).hasClass("asc")?($(this).removeClass("asc").addClass("desc").attr("data-dir","desc"),$(this).html("&#xe612;")):($(this).removeClass("desc").addClass("asc").attr("data-dir","asc"),$(this).html("&#xe613;")),$('[name="pageNum"]').val(1)}),$("body").on("click",".j-order-sales",function(){c(0,0,$(this).attr("data-dir"),0,0),b()}),$("body").on("click",".j-order-amount",function(){c(0,0,0,$(this).attr("data-dir"),0),b()}),$("body").on("click",".j-order-price",function(){c(0,0,0,0,$(this).attr("data-dir")),b()})}}),define("base/myproduct/search",["jquery","base/myproduct/getData","base/myproduct/initParams","base/utils"],function(a,b,c,d){function h(){var a=/^\s*$/;if(a.test(g.val())){d.tool.alert("搜索关键字不能为空！");return}f.find('option[value="search"]').length||f.append('<option value="search">所有商品</option>').val("search").trigger("chosen:updated.chosen"),g.val().length>100&&g.val(g.val().slice(0,100)),c(1,0,0,0,0,"search"),$('[name="pageNum"]').val(1),b()}var e=$(".am-table-sort em"),f=$('select[name="productStatus"]'),g=$(".am-form-search input");g.on("keydown",function(a){var a=a||event;a.keyCode==13&&h()}),$(".am-form-search .am-icon-search").on("click",function(){h()})}),require(["jquery","base/utils"],function(a,b){}),require(["base/myproduct/getData","base/utils"],function(a,b){var c={ONSALE:"onsale",DRAFT:"draft",FORSALE:"delay"};b.tool.request("status")&&($('select[name="productStatus"]').find('[value="'+c[b.tool.request("status")]+'"]').attr("selected",!0),$('select[name="productStatus"]').trigger("chosen:updated.chosen"),$('#pagerForm [name="status"]').val(c[b.tool.request("status")])),a()}),require(["base/myproduct/down"]),require(["base/myproduct/up"]),require(["base/myproduct/change"]),require(["base/myproduct/sort"],function(a){a()}),require(["base/myproduct/search"]),define("base/myproduct",function(){})